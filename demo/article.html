<!DOCTYPE html>
<html lang="en">
<head>
<title>Mashing it up - the new beta USC Map and Event Calendar APIs</title>    

<!--meta cluster--> 
<meta charset="UTF-8"> 
<meta name="robots" content="all"> 
 
<!--favicon & live bookmark--> 
<link rel="shortcut icon" type="image/ico" href="http://www.usc.edu/favicon.ico"> 
 
<!--css-->
<link rel="stylesheet" href="css/template.css" type="text/css"> 

<!-- uscmap specific styling -->
<link href='css/default.css' rel='stylesheet' type='text/css' />

</head>
<body>
<div id="usc"> 
	<a href="http://www.usc.edu">University of Southern California</a> 
</div><!--/#usc--> 
 
<div id="branding">Mashing it up - the USC Map and Event Calendar APIs</div><!--/#branding--> 

<div class="content-main">
<p>
<h2>What's happening near me at USC?</h1>
<p>
<p>by <author>R. S. Doiel, Software Engineer for USC Web Services</author></p>
<p>

<p>Ever wonder what was happening on campus around you or near a building you'll be at? With two new Web Services APIs you can start to answer that question. </p>

<p>We need four things to get solve this problem.</p>

<ul>
<li>the location of interest (e.g. longitude and latitude or building name)</li>
<li>a list of locations with longitude and latitude (i.e. so we can calculate distance)</li>
<li>a means of calculating what is closest</li>
<li>list of events and with their location</li>
</ul>


<h2>Getting your desired location</h2>

<p>Browsers Chrome, Firefox and Safari offer the geolocation support. This is particularly true
for mobile browsers.  But to keep this demo simple I'm going to create a list of locations
to pick from and will leave the browser location version as an exercise for later.

<p>Here's what 'There are many tutor <a href="http://www.google.com/#hl=en&source=hp&q=HTML5+geolocation+example" title="run the google search to find articles on html5 and geolocation">google search</a> will reveal there are many articles about <a href="http://html5demos.com/geo" title="demonstration of geolocation at work in a webpage">geolocation</a> support in browsers. Here's a quick fragment of JavaScript code to describe how that works.</p>

<code><pre>
/* success if a function we use if we can get the geolocation position */
success = function (position) {
  /* This is where you would put the code to update the location information for the UI */
	alert("You are at longitude: " + position.coords.longitude + " and latitude: " + position.coords.latitude);
}

/* error is a function we use if something goes wrong. */
error = function (msg) {
  /* This is where you would do your error handling and update your UI. */
  alert("ERROR: " + msg);
}

/* Once the browser finds a reference to "navigator.geolocation" it will prompt you for permission to use it. */
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(success, error);
} else {
  error('Your browser does not support geolocation.');
}
</pre><code>

<h2>Getting a list of locations with their longitude and latitude</h2>

<p>The new beta USC Map API includes support to list locations with their longitude and latitude.  Getting a list of locations with that can be done through the following URL <a href="http://web-app.usc.edu/ws/uscmap/api/locations?fields=lat,lng">http://web-app.usc.edu/ws/uscmap/api/locations?fields=lat,lng</a>. This provides you with a list of USC locations featured on the USC Google map and Mobile Map.</p>

<code><pre>
[{"location_id":"1","map_name":"Bovard Auditorium","building_code":"ADM","lat":"34.0209388733","lng":"-118.2855682373"},
{"location_id":"2","map_name":"Newman Recital Hall","building_code":"AHF","lat":"34.0197982788","lng":"-118.2845840454"},
...,
{"location_id":"655","map_name":"Waite Phillips Hall Computer Center","building_code":"WPH","lat":"34.0219497681","lng":"-118.2838287354"}]
</pre></code>

<p>This is what you'll use to determine which building is closest to you. [FIXME: Show some JavaScript to make this calculation.]</p>

<h2>Getting an event list from the USC Public events calendar</h2>

<p>The new beta USC Public Event Calendar API is called eo3. You can get a list of events for the upcoming week with their location by using the following URL <a href="http://web-app.usc.edu/ws/eo3/api/highlights/32/today/+1%20week">http://web-app.usc.edu/ws/eo3/api/highlights/32/today/+1%20week</a>.</p>

<h2>Combine the two lists</h2>

<p>You can now look through the list of events and make a new list by matching the building codes. You can see the final results <a href="http://web-app.usc.edu/ws/uscmap/demo/near-by-events.html">here</a>.</p>

<h2>More information about the APIs</h2>

<p>These two API are in beta so they will like change and refine over the coming months.  The documentation for what is currently implemented can be viewed at <a href="http://web-app.usc.edu/ws/uscmap/help">http://web-app.usc.edu/ws/uscmap/help</a> and <a href="http://web-app.usc.edu/ws/eo3/help">http://web-app.usc.edu/ws/eo3/help</a>.</p>

</div>
<div id="site-info">
	<span id="copyright">copyright &copy; 2010 University of Southern California</span>
</div><!-- /#site-info -->
</html>
